// Copyright 2023 Matt Borland
// Distributed under the Boost Software License, Version 1.0.
// https://www.boost.org/LICENSE_1_0.txt

#ifndef BOOST_DECIMAL_DETAIL_POWER_TABLES_HPP
#define BOOST_DECIMAL_DETAIL_POWER_TABLES_HPP

#include <boost/decimal/detail/config.hpp>
#include <boost/decimal/detail/type_traits.hpp>
#include "int128.hpp"
#include <boost/decimal/detail/u256.hpp>

#ifndef BOOST_DECIMAL_BUILD_MODULE
#include <cstdint>
#endif

namespace boost {
namespace decimal {
namespace detail {

namespace impl {

BOOST_DECIMAL_INLINE_CONSTEXPR_VARIABLE std::uint32_t powers_of_10_u32[10] =
{
    UINT32_C(1), UINT32_C(10), UINT32_C(100), UINT32_C(1000), UINT32_C(10000), UINT32_C(100000), UINT32_C(1000000),
    UINT32_C(10000000), UINT32_C(100000000), UINT32_C(1000000000),
};

BOOST_DECIMAL_INLINE_CONSTEXPR_VARIABLE std::uint64_t powers_of_10[20] =
{
    UINT64_C(1), UINT64_C(10), UINT64_C(100), UINT64_C(1000), UINT64_C(10000), UINT64_C(100000), UINT64_C(1000000),
    UINT64_C(10000000), UINT64_C(100000000), UINT64_C(1000000000), UINT64_C(10000000000), UINT64_C(100000000000),
    UINT64_C(1000000000000), UINT64_C(10000000000000), UINT64_C(100000000000000), UINT64_C(1000000000000000),
    UINT64_C(10000000000000000), UINT64_C(100000000000000000), UINT64_C(1000000000000000000),
    UINT64_C(10000000000000000000)
};

BOOST_DECIMAL_INLINE_CONSTEXPR_VARIABLE boost::int128::uint128_t BOOST_DECIMAL_DETAIL_INT128_pow10[39] =
{
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(1000000000000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(10000000000000000000000000000000000000),
    BOOST_DECIMAL_DETAIL_INT128_UINT128_C(100000000000000000000000000000000000000)
};

#ifdef BOOST_DECIMAL_HAS_INT128

BOOST_DECIMAL_INLINE_CONSTEXPR_VARIABLE detail::builtin_uint128_t builtin_128_pow10[39] = {
    detail::builtin_uint128_t(1),
    detail::builtin_uint128_t(10),
    detail::builtin_uint128_t(100),
    detail::builtin_uint128_t(1000),
    detail::builtin_uint128_t(10000),
    detail::builtin_uint128_t(100000),
    detail::builtin_uint128_t(1000000),
    detail::builtin_uint128_t(10000000),
    detail::builtin_uint128_t(100000000),
    detail::builtin_uint128_t(1000000000),
    detail::builtin_uint128_t(10000000000),
    detail::builtin_uint128_t(100000000000),
    detail::builtin_uint128_t(1000000000000),
    detail::builtin_uint128_t(10000000000000),
    detail::builtin_uint128_t(100000000000000),
    detail::builtin_uint128_t(1000000000000000),
    detail::builtin_uint128_t(10000000000000000),
    detail::builtin_uint128_t(100000000000000000),
    detail::builtin_uint128_t(1000000000000000000),
    detail::builtin_uint128_t(10000000000000000000ULL),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(10),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(100),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(1000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(10000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(100000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(1000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(10000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(100000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(1000000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(10000000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(100000000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(1000000000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(10000000000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(100000000000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(1000000000000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(10000000000000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(100000000000000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(1000000000000000000),
    detail::builtin_uint128_t(10000000000000000000ULL) * detail::builtin_uint128_t(10000000000000000000ULL),
};

#endif

BOOST_DECIMAL_INLINE_CONSTEXPR_VARIABLE u256 u256_pow_10[78] = {
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[0]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[1]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[2]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[3]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[4]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[5]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[6]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[7]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[8]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[9]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[10]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[11]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[12]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[13]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[14]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[15]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[16]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[17]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[18]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[19]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[20]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[21]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[22]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[23]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[24]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[25]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[26]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[27]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[28]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[29]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[30]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[31]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[32]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[33]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[34]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[35]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[36]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[37]},
    u256{BOOST_DECIMAL_DETAIL_INT128_pow10[38]},
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[1]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[2]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[3]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[4]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[5]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[6]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[7]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[8]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[9]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[10]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[11]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[12]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[13]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[14]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[15]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[16]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[17]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[18]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[19]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[20]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[21]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[22]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[23]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[24]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[25]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[26]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[27]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[28]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[29]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[30]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[31]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[32]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[33]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[34]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[35]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[36]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[37]),
    umul256(BOOST_DECIMAL_DETAIL_INT128_pow10[38], BOOST_DECIMAL_DETAIL_INT128_pow10[38])
};

} // namespace impl

#if defined(__GNUC__) && __GNUC__ >= 7
#  pragma GCC diagnostic push
#  pragma GCC diagnostic ignored "-Warray-bounds"
#endif

template <typename T>
constexpr auto pow10(T n) noexcept -> T
{
    return static_cast<T>(impl::powers_of_10[static_cast<std::size_t>(n)]);
}

template <>
constexpr auto pow10(const boost::int128::uint128_t n) noexcept -> boost::int128::uint128_t
{
    return impl::BOOST_DECIMAL_DETAIL_INT128_pow10[static_cast<std::size_t>(n.low)];
}

#ifdef BOOST_DECIMAL_HAS_INT128

template <>
constexpr auto pow10(detail::builtin_uint128_t n) noexcept -> detail::builtin_uint128_t
{
    return impl::builtin_128_pow10[static_cast<std::size_t>(n)];
}

#endif

constexpr auto pow10(const u256& n) noexcept -> u256
{
    return impl::u256_pow_10[n[3]];
}

#if defined(__GNUC__) && __GNUC__ >= 7
#  pragma GCC diagnostic pop
#endif

} // namespace detail
} // namespace decimal
} // namespace boost

#endif // BOOST_DECIMAL_DETAIL_POWER_TABLES_HPP
